"use strict";function addChart(a){function t(){var t=google.visualization.arrayToDataTable(a),e={is3D:!0};new google.visualization.PieChart(document.getElementById("piechart")).draw(t,e)}google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback(t)}function truncate(a,t){return a.length>t?a.slice(0,t-3)+"...":a}function addPublicationDate(a){var a=new Date(a);return a.getDate()+"."+a.getMonth()+"1."+a.getFullYear()}function find(a,t){for(var e=0;e<a.length;e++)if(a[e]==t)return e;return-1}function doublicate(a){var t=[["Countries","Percentage"]],e={};a.forEach(function(a){e[a]=e[a]+1||1});for(var n in e)t.push([n,e[n]]);return t}$(document).ready(function(){var a,t,e=[],n=[],o=[];$.ajax({type:"GET",url:"http://codeit.pro/frontTestTask/company/getList",success:function(t){a=t,$(".j-comp-total-count").html(a.list.length);for(var r=0;r<a.list.length;r++)$("<li class='company-name'></li>").appendTo($(".j-comp-list-box__ul")),e.push(a.list[r].location.name),o.push(a.list[r]);n=doublicate(e),addChart(n),$(window).resize(function(a){addChart(n)}),$.each($(".company-name"),function(t){$("<a class='company-name-a'></a>").html(a.list[t].name).appendTo(this)}),$(".company-name-a").on("click",function(){$(".comp-partners-box ul").children().remove();var a=$(this).html();return $(".company-name").removeClass("active"),$(this).parent().addClass("active"),$(".comp-partners").slideDown(500),function(){for(var t=a,e=0;e<o.length;e++)if(t==o[e].name)for(var n=0;n<o[e].partners.length;n++)$("<li><span class='circle'></span><span class='square'></span></li>").appendTo($(".comp-partners-box ul")),$(".square").children().remove(),$.each($(".square"),function(a){$("<p></p>").html(o[e].partners[a].name).appendTo(this)}),$(".circle").children().remove(),$.each($(".circle"),function(a){$("<p></p>").html(o[e].partners[a].value+"%").appendTo(this)})}(),!0}),$(".comp-partners").on("click",function(){$(this).slideUp(500)}),$.each($(".flex-container"),function(a){$(".loader").remove()})}}),$.ajax({type:"GET",url:"http://codeit.pro/frontTestTask/news/getList",success:function(a){t=a;for(var e=0;e<t.list.length;e++)$("<li class='carousel-box clearfix'></li>").html($("<img src='' alt='article image' class='author-photo'>").attr("src",t.list[e].img)).appendTo($(".carousel"));$.each($(".carousel-box"),function(a){$("<a href='#'></a>").html(t.list[a].author).appendTo(this),$("<p class='clearfix'></p>").html(truncate(t.list[a].description,185)).css("margin-bottom","15px").appendTo(this),$("<span class='author'>Author: </span>").appendTo(this),$("<p class='author-name'></p><br>").html(t.list[a].author).appendTo(this),$("<span class='public'>Public: </span>").appendTo(this),$("<p class='public-date'></p>").html(addPublicationDate(+t.list[a].date)).appendTo(this)}),$(".carousel").bxSlider()}})});